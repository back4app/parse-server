"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _AuthAdapter = _interopRequireDefault(require("./AuthAdapter"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); } /**
 * Parse Server authentication adapter for OAuth2 Token Introspection.
 *
 * @class OAuth2Adapter
 * @param {Object} options - The adapter configuration options.
 * @param {string} options.tokenIntrospectionEndpointUrl - The URL of the token introspection endpoint. Required.
 * @param {boolean} options.oauth2 - Indicates that the request should be handled by the OAuth2 adapter. Required.
 * @param {string} [options.useridField] - The field in the introspection response that contains the user ID. Optional.
 * @param {string} [options.appidField] - The field in the introspection response that contains the app ID. Optional.
 * @param {string[]} [options.appIds] - List of allowed app IDs. Required if `appidField` is defined.
 * @param {string} [options.authorizationHeader] - The Authorization header value for the introspection request. Optional.
 *
 * @description
 * ## Parse Server Configuration
 * To configure Parse Server for OAuth2 Token Introspection, use the following structure:
 * ```json
 * {
 *   "auth": {
 *     "oauth2Provider": {
 *       "tokenIntrospectionEndpointUrl": "https://provider.com/introspect",
 *       "useridField": "sub",
 *       "appidField": "aud",
 *       "appIds": ["my-app-id"],
 *       "authorizationHeader": "Basic dXNlcm5hbWU6cGFzc3dvcmQ=",
 *       "oauth2": true
 *     }
 *   }
 * }
 * ```
 *
 * The adapter requires the following `authData` fields:
 * - `id`: The user ID provided by the client.
 * - `access_token`: The access token provided by the client.
 *
 * ## Auth Payload
 * ### Example Auth Payload
 * ```json
 * {
 *   "oauth2": {
 *     "id": "user-id",
 *     "access_token": "access-token"
 *   }
 * }
 * ```
 *
 * ## Notes
 * - `tokenIntrospectionEndpointUrl` is mandatory and should point to a valid OAuth2 provider's introspection endpoint.
 * - If `appidField` is defined, `appIds` must also be specified to validate the app ID in the introspection response.
 * - `authorizationHeader` can be used to authenticate requests to the token introspection endpoint.
 *
 * @see {@link https://datatracker.ietf.org/doc/html/rfc7662 OAuth 2.0 Token Introspection Specification}
 */
class OAuth2Adapter extends _AuthAdapter.default {
  validateOptions(options) {
    var _options$appIds;
    super.validateOptions(options);
    if (!options.tokenIntrospectionEndpointUrl) {
      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'OAuth2 token introspection endpoint URL is missing.');
    }
    if (options.appidField && !((_options$appIds = options.appIds) !== null && _options$appIds !== void 0 && _options$appIds.length)) {
      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'OAuth2 configuration is missing app IDs.');
    }
    this.tokenIntrospectionEndpointUrl = options.tokenIntrospectionEndpointUrl;
    this.useridField = options.useridField;
    this.appidField = options.appidField;
    this.appIds = options.appIds;
    this.authorizationHeader = options.authorizationHeader;
  }
  async validateAppId(authData) {
    if (!this.appidField) {
      return;
    }
    const response = await this.requestTokenInfo(authData.access_token);
    const appIdFieldValue = response[this.appidField];
    const isValidAppId = Array.isArray(appIdFieldValue) ? appIdFieldValue.some(appId => this.appIds.includes(appId)) : this.appIds.includes(appIdFieldValue);
    if (!isValidAppId) {
      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'OAuth2: Invalid app ID.');
    }
  }
  async validateAuthData(authData) {
    const response = await this.requestTokenInfo(authData.access_token);
    if (!response.active || this.useridField && authData.id !== response[this.useridField]) {
      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'OAuth2 access token is invalid for this user.');
    }
    return {};
  }
  async requestTokenInfo(accessToken) {
    const response = await fetch(this.tokenIntrospectionEndpointUrl, {
      method: 'POST',
      headers: _objectSpread({
        'Content-Type': 'application/x-www-form-urlencoded'
      }, this.authorizationHeader && {
        Authorization: this.authorizationHeader
      }),
      body: new URLSearchParams({
        token: accessToken
      })
    });
    if (!response.ok) {
      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'OAuth2 token introspection request failed.');
    }
    return response.json();
  }
}
var _default = exports.default = new OAuth2Adapter();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXV0aEFkYXB0ZXIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIm93bktleXMiLCJyIiwidCIsIk9iamVjdCIsImtleXMiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJvIiwiZmlsdGVyIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsInB1c2giLCJhcHBseSIsIl9vYmplY3RTcHJlYWQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJmb3JFYWNoIiwiX2RlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJkZWZpbmVQcm9wZXJ0eSIsIl90b1Byb3BlcnR5S2V5IiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImkiLCJfdG9QcmltaXRpdmUiLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsImNhbGwiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJOdW1iZXIiLCJPQXV0aDJBZGFwdGVyIiwiQXV0aEFkYXB0ZXIiLCJ2YWxpZGF0ZU9wdGlvbnMiLCJvcHRpb25zIiwiX29wdGlvbnMkYXBwSWRzIiwidG9rZW5JbnRyb3NwZWN0aW9uRW5kcG9pbnRVcmwiLCJQYXJzZSIsIkVycm9yIiwiT0JKRUNUX05PVF9GT1VORCIsImFwcGlkRmllbGQiLCJhcHBJZHMiLCJ1c2VyaWRGaWVsZCIsImF1dGhvcml6YXRpb25IZWFkZXIiLCJ2YWxpZGF0ZUFwcElkIiwiYXV0aERhdGEiLCJyZXNwb25zZSIsInJlcXVlc3RUb2tlbkluZm8iLCJhY2Nlc3NfdG9rZW4iLCJhcHBJZEZpZWxkVmFsdWUiLCJpc1ZhbGlkQXBwSWQiLCJBcnJheSIsImlzQXJyYXkiLCJzb21lIiwiYXBwSWQiLCJpbmNsdWRlcyIsInZhbGlkYXRlQXV0aERhdGEiLCJhY3RpdmUiLCJpZCIsImFjY2Vzc1Rva2VuIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImJvZHkiLCJVUkxTZWFyY2hQYXJhbXMiLCJ0b2tlbiIsIm9rIiwianNvbiIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL29hdXRoMi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBhcnNlIFNlcnZlciBhdXRoZW50aWNhdGlvbiBhZGFwdGVyIGZvciBPQXV0aDIgVG9rZW4gSW50cm9zcGVjdGlvbi5cbiAqXG4gKiBAY2xhc3MgT0F1dGgyQWRhcHRlclxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBUaGUgYWRhcHRlciBjb25maWd1cmF0aW9uIG9wdGlvbnMuXG4gKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9ucy50b2tlbkludHJvc3BlY3Rpb25FbmRwb2ludFVybCAtIFRoZSBVUkwgb2YgdGhlIHRva2VuIGludHJvc3BlY3Rpb24gZW5kcG9pbnQuIFJlcXVpcmVkLlxuICogQHBhcmFtIHtib29sZWFufSBvcHRpb25zLm9hdXRoMiAtIEluZGljYXRlcyB0aGF0IHRoZSByZXF1ZXN0IHNob3VsZCBiZSBoYW5kbGVkIGJ5IHRoZSBPQXV0aDIgYWRhcHRlci4gUmVxdWlyZWQuXG4gKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMudXNlcmlkRmllbGRdIC0gVGhlIGZpZWxkIGluIHRoZSBpbnRyb3NwZWN0aW9uIHJlc3BvbnNlIHRoYXQgY29udGFpbnMgdGhlIHVzZXIgSUQuIE9wdGlvbmFsLlxuICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmFwcGlkRmllbGRdIC0gVGhlIGZpZWxkIGluIHRoZSBpbnRyb3NwZWN0aW9uIHJlc3BvbnNlIHRoYXQgY29udGFpbnMgdGhlIGFwcCBJRC4gT3B0aW9uYWwuXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBbb3B0aW9ucy5hcHBJZHNdIC0gTGlzdCBvZiBhbGxvd2VkIGFwcCBJRHMuIFJlcXVpcmVkIGlmIGBhcHBpZEZpZWxkYCBpcyBkZWZpbmVkLlxuICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmF1dGhvcml6YXRpb25IZWFkZXJdIC0gVGhlIEF1dGhvcml6YXRpb24gaGVhZGVyIHZhbHVlIGZvciB0aGUgaW50cm9zcGVjdGlvbiByZXF1ZXN0LiBPcHRpb25hbC5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqICMjIFBhcnNlIFNlcnZlciBDb25maWd1cmF0aW9uXG4gKiBUbyBjb25maWd1cmUgUGFyc2UgU2VydmVyIGZvciBPQXV0aDIgVG9rZW4gSW50cm9zcGVjdGlvbiwgdXNlIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlOlxuICogYGBganNvblxuICoge1xuICogICBcImF1dGhcIjoge1xuICogICAgIFwib2F1dGgyUHJvdmlkZXJcIjoge1xuICogICAgICAgXCJ0b2tlbkludHJvc3BlY3Rpb25FbmRwb2ludFVybFwiOiBcImh0dHBzOi8vcHJvdmlkZXIuY29tL2ludHJvc3BlY3RcIixcbiAqICAgICAgIFwidXNlcmlkRmllbGRcIjogXCJzdWJcIixcbiAqICAgICAgIFwiYXBwaWRGaWVsZFwiOiBcImF1ZFwiLFxuICogICAgICAgXCJhcHBJZHNcIjogW1wibXktYXBwLWlkXCJdLFxuICogICAgICAgXCJhdXRob3JpemF0aW9uSGVhZGVyXCI6IFwiQmFzaWMgZFhObGNtNWhiV1U2Y0dGemMzZHZjbVE9XCIsXG4gKiAgICAgICBcIm9hdXRoMlwiOiB0cnVlXG4gKiAgICAgfVxuICogICB9XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBUaGUgYWRhcHRlciByZXF1aXJlcyB0aGUgZm9sbG93aW5nIGBhdXRoRGF0YWAgZmllbGRzOlxuICogLSBgaWRgOiBUaGUgdXNlciBJRCBwcm92aWRlZCBieSB0aGUgY2xpZW50LlxuICogLSBgYWNjZXNzX3Rva2VuYDogVGhlIGFjY2VzcyB0b2tlbiBwcm92aWRlZCBieSB0aGUgY2xpZW50LlxuICpcbiAqICMjIEF1dGggUGF5bG9hZFxuICogIyMjIEV4YW1wbGUgQXV0aCBQYXlsb2FkXG4gKiBgYGBqc29uXG4gKiB7XG4gKiAgIFwib2F1dGgyXCI6IHtcbiAqICAgICBcImlkXCI6IFwidXNlci1pZFwiLFxuICogICAgIFwiYWNjZXNzX3Rva2VuXCI6IFwiYWNjZXNzLXRva2VuXCJcbiAqICAgfVxuICogfVxuICogYGBgXG4gKlxuICogIyMgTm90ZXNcbiAqIC0gYHRva2VuSW50cm9zcGVjdGlvbkVuZHBvaW50VXJsYCBpcyBtYW5kYXRvcnkgYW5kIHNob3VsZCBwb2ludCB0byBhIHZhbGlkIE9BdXRoMiBwcm92aWRlcidzIGludHJvc3BlY3Rpb24gZW5kcG9pbnQuXG4gKiAtIElmIGBhcHBpZEZpZWxkYCBpcyBkZWZpbmVkLCBgYXBwSWRzYCBtdXN0IGFsc28gYmUgc3BlY2lmaWVkIHRvIHZhbGlkYXRlIHRoZSBhcHAgSUQgaW4gdGhlIGludHJvc3BlY3Rpb24gcmVzcG9uc2UuXG4gKiAtIGBhdXRob3JpemF0aW9uSGVhZGVyYCBjYW4gYmUgdXNlZCB0byBhdXRoZW50aWNhdGUgcmVxdWVzdHMgdG8gdGhlIHRva2VuIGludHJvc3BlY3Rpb24gZW5kcG9pbnQuXG4gKlxuICogQHNlZSB7QGxpbmsgaHR0cHM6Ly9kYXRhdHJhY2tlci5pZXRmLm9yZy9kb2MvaHRtbC9yZmM3NjYyIE9BdXRoIDIuMCBUb2tlbiBJbnRyb3NwZWN0aW9uIFNwZWNpZmljYXRpb259XG4gKi9cblxuXG5pbXBvcnQgQXV0aEFkYXB0ZXIgZnJvbSAnLi9BdXRoQWRhcHRlcic7XG5cbmNsYXNzIE9BdXRoMkFkYXB0ZXIgZXh0ZW5kcyBBdXRoQWRhcHRlciB7XG4gIHZhbGlkYXRlT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgc3VwZXIudmFsaWRhdGVPcHRpb25zKG9wdGlvbnMpO1xuXG4gICAgaWYgKCFvcHRpb25zLnRva2VuSW50cm9zcGVjdGlvbkVuZHBvaW50VXJsKSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ09BdXRoMiB0b2tlbiBpbnRyb3NwZWN0aW9uIGVuZHBvaW50IFVSTCBpcyBtaXNzaW5nLicpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5hcHBpZEZpZWxkICYmICFvcHRpb25zLmFwcElkcz8ubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ09BdXRoMiBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmcgYXBwIElEcy4nKTtcbiAgICB9XG5cbiAgICB0aGlzLnRva2VuSW50cm9zcGVjdGlvbkVuZHBvaW50VXJsID0gb3B0aW9ucy50b2tlbkludHJvc3BlY3Rpb25FbmRwb2ludFVybDtcbiAgICB0aGlzLnVzZXJpZEZpZWxkID0gb3B0aW9ucy51c2VyaWRGaWVsZDtcbiAgICB0aGlzLmFwcGlkRmllbGQgPSBvcHRpb25zLmFwcGlkRmllbGQ7XG4gICAgdGhpcy5hcHBJZHMgPSBvcHRpb25zLmFwcElkcztcbiAgICB0aGlzLmF1dGhvcml6YXRpb25IZWFkZXIgPSBvcHRpb25zLmF1dGhvcml6YXRpb25IZWFkZXI7XG4gIH1cblxuICBhc3luYyB2YWxpZGF0ZUFwcElkKGF1dGhEYXRhKSB7XG4gICAgaWYgKCF0aGlzLmFwcGlkRmllbGQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmVxdWVzdFRva2VuSW5mbyhhdXRoRGF0YS5hY2Nlc3NfdG9rZW4pO1xuXG4gICAgY29uc3QgYXBwSWRGaWVsZFZhbHVlID0gcmVzcG9uc2VbdGhpcy5hcHBpZEZpZWxkXTtcbiAgICBjb25zdCBpc1ZhbGlkQXBwSWQgPSBBcnJheS5pc0FycmF5KGFwcElkRmllbGRWYWx1ZSlcbiAgICAgID8gYXBwSWRGaWVsZFZhbHVlLnNvbWUoYXBwSWQgPT4gdGhpcy5hcHBJZHMuaW5jbHVkZXMoYXBwSWQpKVxuICAgICAgOiB0aGlzLmFwcElkcy5pbmNsdWRlcyhhcHBJZEZpZWxkVmFsdWUpO1xuXG4gICAgaWYgKCFpc1ZhbGlkQXBwSWQpIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnT0F1dGgyOiBJbnZhbGlkIGFwcCBJRC4nKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyB2YWxpZGF0ZUF1dGhEYXRhKGF1dGhEYXRhKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlcXVlc3RUb2tlbkluZm8oYXV0aERhdGEuYWNjZXNzX3Rva2VuKTtcblxuICAgIGlmICghcmVzcG9uc2UuYWN0aXZlIHx8ICh0aGlzLnVzZXJpZEZpZWxkICYmIGF1dGhEYXRhLmlkICE9PSByZXNwb25zZVt0aGlzLnVzZXJpZEZpZWxkXSkpIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnT0F1dGgyIGFjY2VzcyB0b2tlbiBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgYXN5bmMgcmVxdWVzdFRva2VuSW5mbyhhY2Nlc3NUb2tlbikge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy50b2tlbkludHJvc3BlY3Rpb25FbmRwb2ludFVybCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyxcbiAgICAgICAgLi4uKHRoaXMuYXV0aG9yaXphdGlvbkhlYWRlciAmJiB7IEF1dGhvcml6YXRpb246IHRoaXMuYXV0aG9yaXphdGlvbkhlYWRlciB9KVxuICAgICAgfSxcbiAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoeyB0b2tlbjogYWNjZXNzVG9rZW4gfSlcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnT0F1dGgyIHRva2VuIGludHJvc3BlY3Rpb24gcmVxdWVzdCBmYWlsZWQuJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgT0F1dGgyQWRhcHRlcigpO1xuXG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQXNEQSxJQUFBQSxZQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBd0MsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxTQUFBRyxRQUFBSCxDQUFBLEVBQUFJLENBQUEsUUFBQUMsQ0FBQSxHQUFBQyxNQUFBLENBQUFDLElBQUEsQ0FBQVAsQ0FBQSxPQUFBTSxNQUFBLENBQUFFLHFCQUFBLFFBQUFDLENBQUEsR0FBQUgsTUFBQSxDQUFBRSxxQkFBQSxDQUFBUixDQUFBLEdBQUFJLENBQUEsS0FBQUssQ0FBQSxHQUFBQSxDQUFBLENBQUFDLE1BQUEsV0FBQU4sQ0FBQSxXQUFBRSxNQUFBLENBQUFLLHdCQUFBLENBQUFYLENBQUEsRUFBQUksQ0FBQSxFQUFBUSxVQUFBLE9BQUFQLENBQUEsQ0FBQVEsSUFBQSxDQUFBQyxLQUFBLENBQUFULENBQUEsRUFBQUksQ0FBQSxZQUFBSixDQUFBO0FBQUEsU0FBQVUsY0FBQWYsQ0FBQSxhQUFBSSxDQUFBLE1BQUFBLENBQUEsR0FBQVksU0FBQSxDQUFBQyxNQUFBLEVBQUFiLENBQUEsVUFBQUMsQ0FBQSxXQUFBVyxTQUFBLENBQUFaLENBQUEsSUFBQVksU0FBQSxDQUFBWixDQUFBLFFBQUFBLENBQUEsT0FBQUQsT0FBQSxDQUFBRyxNQUFBLENBQUFELENBQUEsT0FBQWEsT0FBQSxXQUFBZCxDQUFBLElBQUFlLGVBQUEsQ0FBQW5CLENBQUEsRUFBQUksQ0FBQSxFQUFBQyxDQUFBLENBQUFELENBQUEsU0FBQUUsTUFBQSxDQUFBYyx5QkFBQSxHQUFB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